<!-- index.html -->
<!DOCTYPE html>
<html lang="id" class="scroll-smooth">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TI UIN Malang – Chatbot Akademik (RAG)</title>
  <!-- <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.2/dist/tailwind.min.css" rel="stylesheet" /> -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="styles.css" />
</head>

<body class="bg-gradient-to-b from-[#0b1020] to-[#0e1b3a] text-slate-200 font-sans min-h-screen flex flex-col">
  <div id="app" class="flex-grow flex flex-col items-center justify-center p-4">
    <main role="main"
      class="relative w-full max-w-3xl flex flex-col bg-[rgba(15,23,42,0.4)] backdrop-blur-[12px] rounded-2xl shadow-lg shadow-black/50 border border-white/10 overflow-hidden"
      style="min-height: 600px; max-height: 90vh;" aria-label="Chatbot Akademik TI UIN Malang">
      <!-- Header -->
      <header class="flex items-center justify-between px-6 py-4 border-b border-white/10 select-none"
        aria-label="Header">
        <div>
          <h1 class="text-xl font-semibold tracking-wide text-cyan-400 drop-shadow-[0_0_4px_rgba(37,99,235,0.7)]">
            TI UIN Malang – Chatbot Akademik (RAG)
          </h1>
          <p class="text-xs text-slate-400 mt-0.5">Tanya & dapatkan jawaban akademik dengan cepat</p>
        </div>
        <button id="btn-settings" aria-label="Buka pengaturan"
          class="text-cyan-400 hover:text-cyan-300 focus:outline-none focus:ring-2 focus:ring-cyan-400 rounded px-2 py-1 transition-colors"
          type="button">
          Settings
        </button>
      </header>

      <!-- Status chip -->
      <div id="status-chip"
        class="absolute top-4 right-4 px-3 py-1 rounded-full text-xs font-mono bg-black/50 text-cyan-400 shadow-[0_0_8px_rgba(37,99,235,0.7)] select-none pointer-events-none"
        aria-live="polite" aria-atomic="true">
        Connecting...
      </div>

      <!-- Chat area -->
      <section id="chat-area"
        class="flex-grow overflow-y-auto px-6 py-4 space-y-4 scrollbar-thin scrollbar-thumb-cyan-600 scrollbar-track-transparent"
        tabindex="0" aria-label="Daftar pesan chatbot">
        <!-- Empty state -->
        <div id="empty-state" class="flex flex-col items-center justify-center text-slate-500 select-none mt-20"
          aria-live="polite">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-20 h-20 mb-4 text-cyan-600 opacity-60" fill="none"
            viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M8 10h.01M12 10h.01M16 10h.01M9 16h6m-3-6v6m-7 4h14a2 2 0 002-2v-5a2 2 0 00-2-2H6a2 2 0 00-2 2v5a2 2 0 002 2z" />
          </svg>
          <p class="max-w-md text-center text-sm leading-relaxed">
            Contoh pertanyaan:<br />
            <em class="text-cyan-400">"Bagaimana prosedur pengajuan beasiswa?"</em><br />
            <em class="text-cyan-400">"Jadwal ujian semester ganjil 2024?"</em>
          </p>
        </div>
      </section>

      <!-- Scroll to bottom button -->
      <button id="btn-scroll-bottom" aria-label="Gulir ke bawah"
        class="hidden absolute bottom-20 right-6 bg-cyan-600/80 hover:bg-cyan-500/90 focus:outline-none focus:ring-2 focus:ring-cyan-400 rounded-full p-2 shadow-lg transition-colors"
        type="button">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24"
          stroke="currentColor" stroke-width="2" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
        </svg>
      </button>

      <!-- Typing indicator -->
      <div id="typing-indicator"
        class="absolute bottom-20 left-6 flex items-center space-x-2 opacity-0 pointer-events-none select-none"
        aria-live="polite" aria-atomic="true">
        <span class="w-3 h-3 rounded-full bg-cyan-400 animate-bounce delay-75"></span>
        <span class="w-3 h-3 rounded-full bg-cyan-400 animate-bounce delay-150"></span>
        <span class="w-3 h-3 rounded-full bg-cyan-400 animate-bounce delay-225"></span>
        <span class="ml-2 text-cyan-400 text-xs font-mono">Bot sedang mengetik...</span>
      </div>

      <!-- Composer -->
      <form id="form-composer"
        class="flex items-center gap-3 px-6 py-4 border-t border-white/10 bg-[rgba(15,23,42,0.6)] backdrop-blur-[12px]"
        aria-label="Formulir pengiriman pesan">
        <textarea id="input-message" rows="1" aria-label="Tulis pesan" placeholder="Tulis pesan..."
          class="flex-grow resize-none rounded-2xl bg-[rgba(255,255,255,0.05)] border border-white/20 text-slate-200 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:border-cyan-400 px-4 py-2 font-sans text-sm leading-snug max-h-40 overflow-y-auto transition-colors"
          spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="sentences"></textarea>
        <button type="submit" id="btn-send"
          class="bg-cyan-600 hover:bg-cyan-500 active:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-cyan-400 rounded-2xl px-5 py-2 text-sm font-semibold text-white select-none transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
          aria-label="Kirim pesan" disabled>
          Kirim
        </button>
      </form>
    </main>
  </div>

  <!-- Toast container -->
  <div id="toast-container" class="fixed bottom-6 left-1/2 -translate-x-1/2 space-y-2 z-50 max-w-sm w-full px-4"
    aria-live="assertive" aria-atomic="true"></div>

  <!-- Settings Modal -->
  <div id="modal-settings"
    class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 opacity-0 pointer-events-none transition-opacity"
    role="dialog" aria-modal="true" aria-labelledby="modal-settings-title">
    <div
      class="bg-[rgba(15,23,42,0.85)] backdrop-blur-[12px] rounded-2xl max-w-lg w-full p-6 shadow-lg shadow-black/70 border border-white/10">
      <h2 id="modal-settings-title" class="text-cyan-400 text-xl font-semibold mb-4">
        Pengaturan Chatbot
      </h2>
      <form id="form-settings" class="space-y-4" novalidate>
        <div>
          <label for="input-base-api" class="block text-sm font-medium text-slate-300 mb-1">
            Base API URL
          </label>
          <input type="url" id="input-base-api" name="baseApiUrl" required
            placeholder="https://your-backend.example.com"
            class="w-full rounded-md bg-[rgba(255,255,255,0.05)] border border-white/20 text-slate-200 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:border-cyan-400 px-3 py-2 text-sm"
            aria-describedby="baseApiHelp" />
          <p id="baseApiHelp" class="text-xs text-slate-500 mt-1">
            URL dasar backend API chatbot.
          </p>
        </div>

        <fieldset class="space-y-2">
          <legend class="text-sm font-medium text-slate-300">Fitur Streaming</legend>
          <label class="inline-flex items-center space-x-2">
            <input type="checkbox" id="input-streaming" name="streaming"
              class="rounded border-white/20 text-cyan-500 focus:ring-cyan-400" />
            <span class="text-sm text-slate-300">Aktifkan Streaming (SSE/WebSocket)</span>
          </label>
        </fieldset>

        <fieldset class="space-y-2">
          <legend class="text-sm font-medium text-slate-300">Gunakan WebSocket</legend>
          <label class="inline-flex items-center space-x-2">
            <input type="checkbox" id="input-use-websocket" name="useWebSocket"
              class="rounded border-white/20 text-cyan-500 focus:ring-cyan-400" />
            <span class="text-sm text-slate-300">Gunakan WebSocket (jika streaming aktif)</span>
          </label>
        </fieldset>

        <div class="flex justify-end space-x-3 pt-4 border-t border-white/10">
          <button type="button" id="btn-cancel-settings"
            class="px-4 py-2 rounded-2xl bg-transparent border border-white/20 text-slate-400 hover:text-white hover:border-white focus:outline-none focus:ring-2 focus:ring-cyan-400 transition-colors">
            Batal
          </button>
          <button type="submit" id="btn-save-settings"
            class="px-4 py-2 rounded-2xl bg-cyan-600 hover:bg-cyan-500 active:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-cyan-400 text-white font-semibold transition-colors">
            Simpan
          </button>
        </div>
      </form>
    </div>
  </div>

  <script src="app.js" type="module"></script>
</body>

</html>